\documentclass[12pt]{article}
\usepackage{epsfig, epsf, graphicx}
\usepackage{pstricks, pst-node, psfrag}
\usepackage{amssymb,amsmath,bm}
\usepackage{verbatim,enumerate}
\usepackage{rotating, lscape}
\usepackage{setspace}
\usepackage{paralist}
\usepackage{apacite}
\usepackage{natbib}
\usepackage{subfig}
\usepackage{physics}
\usepackage{color, colortbl}
\usepackage{tabu}
\usepackage{xcolor}
\usepackage[framemethod=default]{mdframed}
\usepackage{showexpl}

\mdfdefinestyle{exampledefault}{%
linecolor=black,linewidth=1.5pt,
middlelinewidth=3pt,rightline=true,innerleftmargin=10,innerrightmargin=10}
\usepackage{tikz}
\usepackage{multirow}
\usepackage{bbm}
\usetikzlibrary{arrows,calc,tikzmark,shapes,fit,positioning}
\tikzset{box/.style={draw, rectangle, thick, text centered, minimum height=3em}}
  \tikzset{line/.style={draw, thick, -latex'}}
\usepackage{hyperref}
\usepackage{booktabs}
\usepackage{float}
\usepackage{multicol,listings,siunitx}
\usepackage{caption}
%\usepackage[square,sort,comma,numbers]{natbib}
\usepackage{gensymb}
%\usepackage{adjustbox}
\setlength{\oddsidemargin}{-0.125in} \setlength{\topmargin}{-0.5in}
\setlength{\textwidth}{6.5in} \setlength{\textheight}{9in}

\setlength{\textheight}{9in} \setlength{\textwidth}{6.5in}
\setlength{\topmargin}{-40pt} \setlength{\oddsidemargin}{0pt}
\setlength{\evensidemargin}{0pt}

\setlength{\textheight}{9.4in} \setlength{\textwidth}{6.8in}
\setlength{\topmargin}{-71pt} \setlength{\oddsidemargin}{0pt}
\setlength{\evensidemargin}{-6pt} \tolerance=500
%\input psfig.tex
\setlength{\topmargin}{-56pt} \setlength{\oddsidemargin}{-6pt}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\def\wt{\widetilde}
\def\diag{\hbox{diag}}
\def\wh{\widehat}
\def\AIC{\hbox{AIC}}
\def\BIC{\hbox{BIC}}
%- Makes the section title start with Appendix in the appendix environment
\newcommand{\Appendix}
{%\appendix
\def\thesection{Appendix~\Alph{section}}
%\def\thesubsection{\Alph{section}.\arabic{subsection}}
\def\thesubsection{A.\arabic{subsection}}
}
\def\diag{\hbox{diag}}
\def\bias{\hbox{bias}}
\def\Siuu{\boldSigma_{i,uu}}
\def\ANNALS{{\it Annals of Statistics}}
\def\BIOK{{\it Biometrika}}
\def\whT{\widehat{\Theta}}
\def\STATMED{{\it Statistics in Medicine}}
\def\STATSCI{{\it Statistical Science}}
\def\JSPI{{\it Journal of Statistical Planning \&amp; Inference}}
\def\JRSSB{{\it Journal of the Royal Statistical Society, Series B}}
\def\BMCS{{\it Biometrics}}
\def\COMMS{{\it Communications in Statistics, Theory \& Methods}}
\def\JQT{{\it Journal of Quality Technology}}
\def\STIM{{\it Statistics in Medicine}}
\def\TECH{{\it Technometrics}}
\def\AJE{{\it American Journal of Epidemiology}}
\def\JASA{{\it Journal of the American Statistical Association}}
\def\CDA{{\it Computational Statistics \& Data Analysis}}
\def\JCGS{{\it Journal of Computational and Graphical Statistics}}
\def\JCB{{\it Journal of Computational Biology}}
\def\BIOINF{{\it Bioinformatics}}
\def\JAMA{{\it Journal of the American Medical Association}}
\def\JNUTR{{\it Journal of Nutrition}}
\def\JCGS{{\it Journal of Computational and Graphical Statistics}}
\def\LETTERS{{\it Letters in Probability and Statistics}}
\def\JABES{{\it Journal of Agricultural and
                      Environmental Statistics}}
\def\JASA{{\it Journal of the American Statistical Association}}
\def\ANNALS{{\it Annals of Statistics}}
\def\JSPI{{\it Journal of Statistical Planning \& Inference}}
\def\TECH{{\it Technometrics}}
\def\BIOK{{\it Bio\-me\-tri\-ka}}
\def\JRSSB{{\it Journal of the Royal Statistical Society, Series B}}
\def\BMCS{{\it Biometrics}}
\def\COMMS{{\it Communications in Statistics, Series A}}
\def\JQT{{\it Journal of Quality Technology}}
\def\SCAN{{\it Scandinavian Journal of Statistics}}
\def\AJE{{\it American Journal of Epidemiology}}
\def\STIM{{\it Statistics in Medicine}}
\def\ANNALS{{\it Annals of Statistics}}
\def\whT{\widehat{\Theta}}
\def\STATMED{{\it Statistics in Medicine}}
\def\STATSCI{{\it Statistical Science}}
\def\JSPI{{\it Journal of Statistical Planning \& Inference}}
\def\JRSSB{{\it Journal of the Royal Statistical Society, Series B}}
\def\BMCS{{\it Biometrics}}
\def\COMMS{{\it Communications in Statistics, Theory \& Methods}}
\def\JQT{{\it Journal of Quality Technology}}
\def\STIM{{\it Statistics in Medicine}}
\def\TECH{{\it Technometrics}}
\def\AJE{{\it American Journal of Epidemiology}}
\def\JASA{{\it Journal of the American Statistical Association}}
\def\CDA{{\it Computational Statistics \& Data Analysis}}
\def\dfrac#1#2{{\displaystyle{#1\over#2}}}
\def\VS{{\vskip 3mm\noindent}}
\def\boxit#1{\vbox{\hrule\hbox{\vrule\kern6pt
          \vbox{\kern6pt#1\kern6pt}\kern6pt\vrule}\hrule}}
\def\refhg{\hangindent=20pt\hangafter=1}
\def\refmark{\par\vskip 2mm\noindent\refhg}
\def\naive{\hbox{naive}}
\def\itemitem{\par\indent \hangindent2\pahttprindent \textindent}
\def\var{\hbox{var}}
\def\cov{\hbox{cov}}
\def\corr{\hbox{corr}}
\def\trace{\hbox{trace}}
\def\refhg{\hangindent=20pt\hangafter=1}
\def\refmark{\par\vskip 2mm\noindent\refhg}
\def\Normal{\hbox{Normal}}
\def\povr{\buildrel p\over\longrightarrow}
\def\ccdot{{\bullet}}
\def\bse{\begin{eqnarray*}}
\def\ese{\end{eqnarray*}}
\def\be{\begin{eqnarray}}
\def\ee{\end{eqnarray}}
\def\bq{\begin{equation}}
\def\eq{\end{equation}}
\def\bse{\begin{eqnarray*}}
\def\ese{\end{eqnarray*}}
\def\pr{\hbox{pr}}
\def\CV{\hbox{CV}}
\def\wh{\widehat}
\def\trans{^{\rm T}}
\def\myalpha{{\cal A}}
\def\th{^{th}}

\definecolor{seagreen}{rgb}{0.18,0.55,0.34}
\definecolor{lawngreen}{rgb}{0.49,0.99,0}
\definecolor{lightsalmon}{rgb}{1,0.63,0.48}
\definecolor{lightyellow}{rgb}{0.99,0.906,0.429}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Marc Definitions
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\renewcommand{\baselinestretch}{1.2} % Change this 1.5 or whatever
%\DeclareMathOperator{\Tr}{tr}
\newcommand{\qed}{\hfill\hfill\vbox{\hrule\hbox{\vrule\squarebox
   {.667em}\vrule}\hrule}\smallskip}
\newcommand{\bbR}{\mathbb{R}}
\newcommand{\bbX}{\mathbb{X}}
\newcommand{\bI}{\mathbf{I}}
\newcommand{\bX}{\mathbf{X}}
\newcommand{\bY}{\mathbf{Y}}
\newcommand{\bZ}{\mathbf{Z}}
\newcommand{\bP}{\mathbf{P}}
\newcommand{\bR}{\mathbf{R}}
\newcommand{\bU}{\mathbf{U}}
\newcommand{\br}{\mathbf{r}}
\newcommand{\bL}{\mathbf{L}}
\newcommand{\bW}{\mathbf{W}}
\newcommand{\bT}{\mathbf{T}}
\newcommand{\bx}{\mathbf{x}}
\newcommand{\bz}{\mathbf{z}}
\newcommand{\bs}{\mathbf{s}}
\newcommand{\bu}{\mathbf{u}}
\newcommand{\bmu}{\mathbf{\mu}}
\newcommand{\bdelta}{\mathbf{\delta}}
\newcommand{\bepsilon}{\boldsymbol{\epsilon}}
\newcommand{\balpha}{\boldsymbol{\alpha}}
\newcommand{\bbeta}{\boldsymbol{\beta}}
\newcommand{\btheta}{\boldsymbol{\theta}}
\newcommand{\bLambda}{\boldsymbol{\Lambda}}
\newcommand{\bSigma}{\boldsymbol{\Sigma}}
\newcommand{\0}{\mathbf{0}}
\newtheorem{defi}{Definition}
%\theoremstyle{plain}
\newtheorem{theo}{Theorem}
\newtheorem{corollary}{Corollary}
\newtheorem{prop}{Proposition}
\newtheorem{lem}{Lemma}
%\theoremstyle{remark}
\newtheorem{rem}{Remark}
\newtheorem{proof}{Proof}

% \renewcommand{\baselinestretch}{1.25}
\pagenumbering{arabic}


\begin{document}

\thispagestyle{empty} \baselineskip=28pt \vskip 5mm
\begin{center} {\LARGE{\bf Spatio-Temporal Cross-Covariance Functions under the Lagrangian Framework}}
	
\end{center}

\baselineskip=12pt \vskip 10mm

\begin{center}\large
Mary Lai O. Salva\~{n}a, Amanda Lenzi, and Marc G.~Genton\footnote[1]{\baselineskip=10pt Statistics Program, King Abdullah University of Science and Technology (KAUST), Thuwal 23955-6900, Saudi Arabia\\
E-mail: marylai.salvana@kaust.edu.sa amanda.lenzi@kaust.edu.sa marc.genton@kaust.edu.sa\\
This research was supported by the King Abdullah University of Science and Technology (KAUST).}
\end{center}

\baselineskip=17pt \vskip 10mm \centerline{\today} \vskip 15mm

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{center}
{\large{\bf Abstract}}
\end{center} 
The considerable amounts of multivariate spatio-temporal environmental and earth sciences data available today have created a need for models that describe their multivariate spatio-temporal dependencies. Under the assumption of Gaussianity, one needs to specify a spatio-temporal cross-covariance function that describes the relationship between variables. The cross-covariance function is chosen such that it can model the true physical characteristics of an observed phenomenon with the additional requirement of positive definiteness. In most atmospheric data such as pollutants at different levels of the atmosphere, a special property is observed: the covariances and cross-covariances along the direction at which a prevailing weather system travels is stronger than the ones lying in other directions. This resulting dynamics prompts the use of a Lagrangian reference frame wherein we describe the development of a phenomenon in space and in time while moving or travelling with it. Such covariance models have been proposed in the past but only in the univariate setting. We propose and investigate their multivariate extension. A simulation study shows that the parameters of these covariance models can be efficiently estimated, using weighted least squares, and that spatio-temporal cross-covariance functions built under the Lagrangian framework outperform other spatio-temporal cross-covariance models of the aforementioned phenomenon. We demonstrate the modeling approach on a bivariate pollutant dataset of particulate matter in Saudi Arabia. We observe substantial improvements in forecast accuracy. 
\baselineskip=14pt

\par\vfill\noindent
{\bf Some key words:} cross-covariance function; estimation; Lagrangian framework; spatio-temporal;  transport effect.

\clearpage\pagebreak\newpage \pagenumbering{arabic}
\baselineskip=26pt

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Introduction}\label{sec:intro}

Many environmental and earth sciences datasets record several variables over certain locations at certain periods of time. These datasets contain rich spatio-temporal information. Appropriate models to enhance spatio-temporal prediction, not only within each variable but also between the variables, are in great demand. Under the assumption of Gaussianity, this entails specifying a spatio-temporal cross-covariance function that describes the relationship between variables and their spatio-temporal dependencies. The cross-covariance function should model the true physical characteristics of an observed phenomenon with the additional requirement of positive definiteness; see \cite{genton2015cross} and \cite{alegria2017covariance} for recent reviews. 

Consider a spatio-temporal process 
$\mathbf{Y}(\mathbf{s},t)=\left\{Y_1(\mathbf{s},t),\ldots,Y_p(\mathbf{s},t)\right\}^T$, $(\mathbf{s},t)\in  \mathbb{R}^d \times \mathbb{R}$,
such that at each spatial location $\mathbf{s} \in \mathbb{R}^d, d\geq 1$, and at each time $t\in\mathbb{R}$, there are $p$ variables. Assume that $\mathbf{Y}(\mathbf{s},t)$ can be decomposed into a sum of a deterministic and a random component:
\begin{equation*}
\mathbf{Y}(\mathbf{s},t) =\boldsymbol{\mu}(\mathbf{s},t)+\mathbf{Z}(\mathbf{s},t),\quad (\mathbf{s},t)\in \mathbb{R}^d\times \mathbb{R},
\end{equation*}
where $\boldsymbol{\mu}(\cdot)$ is a trend function, and $\mathbf{Z}(\cdot)$ a zero mean multivariate spatio-temporal Gaussian process. Under the Gaussian framework, $\mathbf{Z}(\cdot)$ is completely characterized by its mean and spatio-temporal stationary cross-covariance matrix-valued function $\mathbf{C}(\mathbf{h},u)=\left\{C_{ij}(\mathbf{h},u)\right\}_{i,j=1}^{p},$ which depends only on the spatio-temporal lag $(\mathbf{h},u)\in \mathbb{R}^d\times \mathbb{R}$ under stationarity, for $i,j=1,\ldots,p$:
\begin{equation} \label{eqn:stationarity}
C_{ij}(\mathbf{h},u)=\text{cov}\left\{Z_i(\mathbf{s},t),Z_j(\mathbf{s}+\mathbf{h},t+u)\right\},\quad \mathbf{s},\mathbf{s}+\mathbf{h}\in \mathbb{R}^d, \quad t,t+u\in \mathbb{R}.
\end{equation}

The matrix $\mathbf{C}(\mathbf{h},u)$ is always symmetric (a necessary condition for positive definiteness), but the stationary cross-covariance function $C_{ij}(\mathbf{h},u)$ is not necessarily symmetric when $i\neq j$; however, it is invariant with respect to the joint exchange of the variables and the sign of the spatio-temporal lag $(\mathbf{h},u)$, i.e., $C_{ij}(\mathbf{h},u)=C_{ji}(-\mathbf{h},-u)$ and $C_{ij}(-\mathbf{h},u)=C_{ji}(\mathbf{h},-u),$ for all $(\mathbf{h},u) \in \mathbb{R}^{d}\times \mathbb{R}$. Full symmetry, which is a more restrictive assumption, means that $C_{ij}(\mathbf{h},u)=C_{ij}(-\mathbf{h},u)=C_{ij}(\mathbf{h},-u)=C_{ij}(-\mathbf{h},-u)$. In other words, the cross-covariance between observations on variable $i$ at site $\mathbf{s}_1$, at time $t_1$, and observations on variable $j$ at site $\mathbf{s}_2$, at time $t_2$, where $\mathbf{s}_2=\mathbf{s}_1+\mathbf{h}$ and $t_2=t_1+u$, is identical to that of variable $i$ at site $\mathbf{s}_1$, at time $t_2$, and variable $j$ at site $\mathbf{s}_2$, at time $t_1$. This assumption of full-symmetry is known to not hold in reality, especially when modeling environmental and earth sciences data that are influenced by natural occurring forces. For example, many weather variables occuring in the lowest part of the atmosphere move, due to turbulent flows caused by weather systems. When modeling a bivariate pollutant dataset in Saudi Arabia, we only assume stationarity of the covariance function, as in (\ref{eqn:stationarity}), and we cannot assume full-symmetry because the pollutant is in general transported by the wind. This means that if in a certain geographic region the wind blows from West to East, the measurements at a station on the West coast, for example, would be highly correlated to measurements taken at stations on the East coast at a certain future time. This cannot be said about the correlation of measurements taken from a station on the East coast with future measurements taken on the West coast. This would violate the assumption of full-symmetry. 

%Starting from a valid univariate purely spatial covariance function, the easiest way to build an asymmetric spatio-temporal version is to introduce an appropriate transformation to the spatial coordinates that incorporates the information of a prevailing weather system which transports the random field being studied. Ma (2003) gave a general method of constructing spatio-temporal covariance functions from a purely spatial covariance function, of which Equation (\ref{coxishameq}) below is a particular example. The reader is referred to Theorem 1, Corollaries 1.1-1.3 in Ma (2003). The simplicity of constructing valid spatio-temporal covariance functions in this manner is very appealing. \nocite{ma2003}

The pioneering work on spatio-temporal covariance functions under the Lagrangian framework was initiated by \citet{cox1988} in the univariate setting. Consider a purely spatial random field with a stationary covariance function $C^S(\mathbf{h})$, $\mathbf{h} \in \mathbb{R}^d$, and suppose that this entire random field moves forward in time, with a random advection velocity vector $\mathbf{V} \in \mathbb{R}^d$. This means that the entire random field, i.e., observations from all spatial locations $\mathbf{s}_l\in \mathbb{R}^d,\; l=1,\ldots,N,$ where $N$ is the total number of observations in space, are being advected or transported by one and the same random advection velocity vector. Through the advection velocity, $\mathbf{V}$, one can transform a purely spatial random field into a spatio-temporal random field. Here, $\mathbf{V}$ introduces an appropriate transformation to the spatial coordinates that incorporates the information of a prevailing weather system. The derived univariate spatio-temporal random field has a stationary covariance function
\begin{equation}\label{coxishameq}
C(\mathbf{h},u)=E_{\mathbf{V}}\left\{C^S(\mathbf{h}-u\mathbf{V})\right\},\;\;(\mathbf{h},u)\in\mathbb{R}^d\times \mathbb{R},
\end{equation}
where the expectation is taken with respect to the random advection velocity vector $\mathbf{V}$. This random advection velocity vector, in the same dimension as $\mathbf{h}$, has various choices depending on the physicality of the data, and can be justified when included in the model. Depending on the distribution assumed by $\mathbf{V}$, the model in (\ref{coxishameq}) may not obtain an explicit form, although, numerical solutions can be easily obtained. The simplest form of (\ref{coxishameq}) may be derived when $\mathbf{V}$ is chosen to be constant, i.e., $\mathbf{V}=\mathbf{v}$. The model is known in the literature as the ``frozen field model" and was first introduced by \citet{gupta1987taylor}. One can think of the frozen field model when, at any time, the pollutant is being advected by a wind blowing at constant speed and direction. Intuitively, we know that this is an unrealistic and highly idealized model of the aforementioned phenomenon. Wind may or may not blow at any time of the day, and when it blows, the wind speed and direction are rarely identical. Hence, a model that allows for variability of the advection/transport is more appropriate.  Explicit representations of (\ref{coxishameq}) are not available in the literature, except for the closed form expression provided in \citet{schlather2010some} when $\mathbf{V}$ is Gaussian and $C^S$ is the squared exponential covariance function.

Several authors have used (\ref{coxishameq}), including \citet{gneiting2006geostatistical}, \citet{lonij2013intra}, \citet{inoue2012spatio}, and \citet{shinozaki2016areal}. When analyzing Irish wind data, \citet{gneiting2006geostatistical} identified a prevailing westerly wind pattern that led them to setting $\mathbf{V}=\mathbf{v}=(v_1,0)^T$, i.e, the advection velocity vector $\mathbf{v}$ with a nonzero longitudinal component $v_1 \in \mathbb{R}$. Applying this knowledge, they fitted a Lagrangian covariance
$C(\mathbf{h},u)=(1-\frac{1}{2v_1}|h_1-uv_1|)_+$,
where $\mathbf{h}=(h_1,h_2)^T$ and $(\cdot)_+=\max(\cdot,0)$.

Despite the many advantages of using covariance functions in the Lagrangian framework presented in the literature, the modeling framework has only been developed and applied in the univariate setting. One of the first mentions of the possible multivariate extension was by \citet{christakos2017spatiotemporal} but no proof, applications, and/or theoretical aspects were discussed. Another earlier attempt was made by \citet{apanasovich2010cross} who did so using latent dimensions. Our goal is to formally propose the multivariate extension of the spatio-temporal covariance function under the Lagrangian framework, and to investigate its properties. In particular, we extend the univariate spatio-temporal covariance functions under the Lagrangian framework to spatio-temporal matrix-valued covariance functions for $\mathbf{Z(\cdot)}$, i.e., matrix-valued covariance functions that verify the well-known requirement of positive definiteness: for any $n \in \mathbb{N}$, for any finite set of points $(\mathbf{s}_1,t_1),\ldots,(\mathbf{s}_n,t_n)$, and for any vector $\boldsymbol{\lambda} \in \mathbb{R}^{np}$, we have $\boldsymbol{\lambda}^T\boldsymbol{\Sigma}\boldsymbol{\lambda}\geq 0, $ where $\boldsymbol{\Sigma}$ is an $n p\times n p$ matrix with $n\times n$ block elements of $p\times p$ matrices $\mathbf{C}(\mathbf{s}_{l}-\mathbf{s}_{r},t_{l}-t_{r})$, $l,r=1,\ldots,n$, $n$ is the total number of spatio-temporal observations and $p$ is the number of variables.

The remainder of the paper is organized as follows. Section \ref{sec:proposed} presents the proposed multivariate extension of (\ref{coxishameq}) and introduces some examples. With the estimation procedure introduced in Section \ref{sec:estimation}, we analyze, in Section \ref{sec:application}, a bivariate pollutant dataset of particulate matter in Saudi Arabia and compare the performances of the three new models proposed in Section \ref{sec:proposed} with two other benchmark models. Section \ref{sec:simulation} describes a simulation study to test the flexibility of the proposed models. Our conclusion is presented in Section \ref{sec:discussion}. Proofs are collected in the Appendix. 


\section{Multivariate Extension of the Lagrangian Framework}\label{sec:proposed}

We introduce a multivariate extension of the spatio-temporal covariance function under the Lagrangian framework. We start with the simple case where all the variables are advected/transported by one and the same advection velocity, and proceed with the case where the variables are advected/transported by different advection velocities. Lastly, we discuss an interesting property involving the advection velocity vectors and the spatial and temporal margins of multivariate spatio-temporal random fields.

\subsection{Single Advection Velocity Vector}

\subsubsection{Main Result}

If there are $p$ variables, and if all are advected by the same underlying random velocity $\mathbf{V} \in \mathbb{R}^d,$ then the multivariate extension of (\ref{coxishameq}) is a valid stationary cross-covariance function. 
\begin{theo} \label{theorem1}
Let $\mathbf{V}$ be a random vector on $\mathbb{R}^d$. If $\mathbf{C}^{S}(\mathbf{h})$ is a valid purely spatial matrix-valued stationary covariance function on $\mathbb{R}^d$, i.e., $\mathbf{C}^{S}(\mathbf{h})=\left\{C_{ij}^{S}(\mathbf{h})\right\}_{i,j=1}^{p},$ then
\begin{equation} \label{eqn:proposed}
\mathbf{C}(\mathbf{h}, u)=E_{\mathbf{V}}\left\{\mathbf{C}^S(\mathbf{h}-u\mathbf{V})\right\},\quad (\mathbf{h},u)\in \mathbb{R}^d \times \mathbb{R},
\end{equation}
is a valid spatio-temporal matrix-valued stationary covariance function on $\mathbb{R}^d \times \mathbb{R}$ provided that the expectation exists.
\end{theo}
When $\mathbf{V}=\mathbf{v}$, (\ref{eqn:proposed}) reduces to 
\begin{equation} \label{eqn:proposed2}
\mathbf{C}(\mathbf{h}, u)=\mathbf{C}^S(\mathbf{h}-u\mathbf{v}),\quad (\mathbf{h},u)\in \mathbb{R}^d \times \mathbb{R}.
\end{equation}
We call the model in (\ref{eqn:proposed2}) the multivariate frozen field model. Here, (\ref{eqn:proposed2}) assumes that the changes, in time, of the multivariate spatial random field values, are only brought by one and the same constant advection velocity vector. 

Because of the flexibility and popularity of the Mat\'{e}rn cross-covariance function, we apply Theorem \ref{theorem1} to the said parametric family in the next subsection.

\subsubsection{Spatio-Temporal Lagrangian Mat\'{e}rn Cross-Covariance Function}

Consider the purely spatial Mat\'{e}rn cross-covariance function of Gneiting et al. (2010). The derived \textit{spatio-temporal Lagrangian Mat\'{e}rn} cross-covariance function has the form
\begin{equation}\label{eqn:purelyspatialmatern}
C_{ij}(\mathbf{h},u)= \rho_{ij} \sigma_{i}\sigma_{j}\frac{2^{1-\nu_{ij}}}{\Gamma\left(\nu_{ij}\right)}E_{\mathbf{V}} \left\{\left(a_{ij}\|\mathbf{h}-u\mathbf{V}\|\right)^{\nu_{ij}}\mathcal{K}_{\nu_{ij}}\left(a_{ij}\|\mathbf{h}-u\mathbf{V}\|\right)\right\},
\end{equation}
where $\mathcal{K}_\nu$ is the modified Bessel function of the second kind of order $\nu$, and $\sigma_{i}^{2}>0$, $\nu_{ii}>0$, and $a_{ii}>0$ are the marginal variance, smoothness, and scale parameters, respectively, for $i=1,\ldots,p$.  The parameters for the cross-covariances include $\rho_{ij}$, $\nu_{ij}$, and $a_{ij}$, for $i,j=1,\ldots,p$, and $i\neq j$, with allowable values given in \citet{gneiting2010matern}. The form (\ref{eqn:purelyspatialmatern}) is derived by a simple substitution of the purely spatial Mat\'{e}rn stationary cross-covariance function to the proposed construction methodology in Theorem \ref{theorem1}.  Here, $\mathbf{V}\in \mathbb{R}^d$ is the common random advection velocity vector that converts the purely spatial Mat\'{e}rn stationary cross-covariance function to the spatio-temporal Lagrangian Mat\'{e}rn stationary cross-covariance function.

It is desirable to obtain an explicit form of (\ref{eqn:purelyspatialmatern}). If $\mathbf{V}\sim\mathcal{N}_d\left(\boldsymbol{\mu},\boldsymbol{\Sigma}\right)$, we can only write its semi-explicit form that depends on a one-dimensional integral. As a result, the model in (\ref{eqn:purelyspatialmatern}) becomes analytically tractable and physically interpretable. 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{prop}\label{prop:closedformmultivariatematern}
Let $\mathbf{V}\sim\mathcal{N}_d\left(\boldsymbol{\mu},\boldsymbol{\Sigma}\right)$. If $\mathbf{C}^S(\mathbf{h})$ is the purely spatial matrix-valued Mat\'{e}rn stationary cross-covariance function, such that the conditions on the parameter space are satisfied (see \citet{apanasovich2012valid} and \citet{gneiting2010matern}), then $\mathbf{C}(\mathbf{h},u)=E_{\mathbf{V}}\left\{\mathbf{C}^S(\mathbf{h}-u\mathbf{V})\right\}$ has entries with semi-explicit form, for $i,j=1,\ldots,p$:
\begin{multline}\label{eqn:closedformmultivariatematern}
C_{ij}(\mathbf{h},u)=\frac{2^{d/2}}{\Gamma\left(\nu_{ij}\right)a_{ij}^d}\int_0^{\infty}z^{\nu_{ij}+d/2-1} \exp\left(-z\right)\Big|u^2\boldsymbol{\Sigma}+\frac{2z}{a_{ij}^2}\mathbf{I}_{d}\Big|^{-1/2}\\
\times \exp\left\{-\frac{1}{2}(\mathbf{h}-u\boldsymbol{\mu})^T\left(u^2\boldsymbol{\Sigma}+\frac{2z}{a_{ij}^2}\mathbf{I}_{d}\right)^{-1}(\mathbf{h}-u\boldsymbol{\mu})\right\} \dd z.
\end{multline}
\end{prop}

Equation (\ref{eqn:closedformmultivariatematern}) can be seen as a multivariate Gaussian with mean $u\boldsymbol{\mu}$ and variance $u^2\boldsymbol{\Sigma}+\frac{2z}{a^2}\mathbf{I}_{d}$ averaged over $Z\sim\Gamma(\nu,1/2)$, where $\mathbf{I}_{d}$ is the identity matrix. The parameter $\nu+d/2$ can be interpreted as an effective number of degrees of freedom characterizing the ensemble induced by the fluctuations of the covariance $\boldsymbol{\Sigma}$. The one-dimensional integral is easily evaluated via numerical approximations. 

When $\mathbf{V}=\mathbf{v}$, we retrieve the multivariate frozen field version of (\ref{eqn:purelyspatialmatern}). 
When $u=0,$ (\ref{eqn:closedformmultivariatematern}) is 
\begin{eqnarray*}
C_{ij}\left(\mathbf{h},0\right)=\frac{1}{ \Gamma(\nu_{ij})} \int_0^{\infty}z^{\nu_{ij}-1} \exp\left(-z\right)\exp\left(-\frac{a_{ij}^2\|\mathbf{h}\|^2}{4z}\right)\dd z=\frac{2^{1-\nu_{ij}}}{ \Gamma(\nu_{ij})} \left(a_{ij}\|\mathbf{h}\|\right)^{\nu_{ij}}\mathcal{K}_{\nu_{ij}}\left(a_{ij}\|\mathbf{h}\|\right),
\end{eqnarray*}
which is exactly the purely spatial Mat\'{e}rn stationary cross-covariance function. When $p=1,$ we obtain the semi-explicit form of the univariate spatio-temporal Lagrangian Mat\'{e}rn. 

\begin{figure}[!htbp]
 \centering
    \subfloat[Model (\ref{eqn:purelyspatialmatern}) with $\mathbf{v}=(0.1,0.1)^T$. ]{ \includegraphics[scale=0.3]{fig1a.pdf} \label{fig:mod3covariance}}%
    \qquad
    \captionsetup[subfloat]{margin=-2cm}
    \subfloat[Model (\ref{eqn:closedformmultivariatematern}) with $\mathbf{V}\sim\mathcal{N}_2\left\{\boldsymbol{\mu}=(0.1,0.1)^T,\boldsymbol{\Sigma}=\left(\protect\begin{smallmatrix}0.01 & 0.00009\\
    0.00009 & 0.00001\protect\end{smallmatrix}\right)\right\}.$]{\includegraphics[scale=0.3]{fig1b.pdf}}%
     \caption{Heatmaps of the spatio-temporal Lagrangian Mat\'{e}rn cross-covariance function for $p=2$, on a $31\times 31$ regular grid in a square $[-1.5,1.5]^2$ with purely spatial Mat\'{e}rn parameters: $\nu_{11}=0.5,\;\nu_{22}=1.5,\;a=0.23,\;\rho_{12}=0.8,\;\sigma_1^2=\sigma_2^2=1$. (a) is the frozen field case, and (b) is the non-frozen field.}
   \label{fig:covariance_single_velocity}
   \end{figure}
   
   \begin{figure}[htb!]
 \centering
    \subfloat[Model (\ref{eqn:purelyspatialmatern}) with $\mathbf{v}=(0.1,0.1)^T$. ]{ \includegraphics[scale=0.34]{fig2a.pdf}\label{fig:mod3covariance}}%
    \qquad
    \captionsetup[subfloat]{margin=-2cm}
    \subfloat[Model (\ref{eqn:closedformmultivariatematern}) with $\mathbf{V}\sim\mathcal{N}_2\left\{\boldsymbol{\mu}=(0.1,0.1)^T,\boldsymbol{\Sigma}=\left(\protect\begin{smallmatrix}0.01 & 0.00009\\
    0.00009 & 0.00001\protect\end{smallmatrix}\right)\right\}.$]{\includegraphics[scale=0.34]{fig2b.pdf}}%
     \caption{Simulated realizations on the unit square for the covariance models in Figure~\ref{fig:covariance_single_velocity}.}
   \label{fig:covariance_single_velocity_realizations}
   \end{figure}
   
Figures~\ref{fig:covariance_single_velocity} and \ref{fig:covariance_single_velocity_realizations} show the covariance models in (\ref{eqn:purelyspatialmatern}) and (\ref{eqn:closedformmultivariatematern}) and their respective simulated spatio-temporal realizations when $p=2$. The models are parameterized, such that, in their frozen field state, the practical range of the variable with a less smooth field, e.g. $Z_1$, with $\nu_{11}<\nu_{22}$, is equal to $0.7$, i.e., $C_{11}(\mathbf{h})/C_{11}(\mathbf{0})\approx 0.05$ when $\|\mathbf{h}\|=0.7$. Spatio-temporal Lagrangian stationary cross-covariance functions of the frozen field type are spatially isotropic but asymmetric in time. This property is evident in Figure~\ref{fig:covariance_single_velocity}(a). However, in the non-frozen case, where there is randomness in the advection velocity vector, the marginal covariances and the cross-covariance are not only asymmetric in time but are now anisotropic in space at nonzero temporal lags, as shown in Figure~\ref{fig:covariance_single_velocity}(b).


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Multiple Advection Velocity Vectors}

If there are $p$ variables, and if each has a different random/constant advection velocity vector, then the models in Equations (\ref{eqn:proposed}) and (\ref{eqn:proposed2}) are not necessarily valid. The positive definiteness condition on the cross-covariance functions makes it non-trivial for the extension of Theorem \ref{theorem1} to allow multiple advection velocity vectors.  In this section, we discuss a few cases for which the models are valid. 

\subsubsection{Stationary Cross-Covariance Functions}

The most straightforward way to allow cross-covariance functions under our proposed construction to have multiple advection velocity vectors while remaining stationary and whose validity is easy to check is by using uncorrelated univariate purely spatial latent random fields, each influenced by different advection velocity vectors. Models of this kind are valid, owing to the validity of univariate spatio-temporal Lagrangian covariance functions of \citet{cox1988} in (\ref{coxishameq}) and the linear model of coregionalization (LMC). Recall that the works of \citet{wackernagel1998} and \citet{gelfand2002multivariate} employing the LMC define a process $\mathbf{Z}(\mathbf{s})$, as follows:
\begin{equation}\label{eqn:lmcprocess}
\mathbf{Z}(\mathbf{s})=\mathbf{A}\mathbf{W}(\mathbf{s}),
\end{equation}
where $\mathbf{A}$ is $p\times R, \; R\leq p$, and the components of $\mathbf{W}(\mathbf{s})$ are independent but not identically distributed. Each component $W_r$ has a marginal correlation function $\rho_r,\;r=1,\ldots,R.$ The cross-covariance structure of the process in ($\ref{eqn:lmcprocess}$) has the following form:
\begin{equation}\label{eqn:lmc1}
\mathbf{C}(\mathbf{h})=\sum_{r=1}^{R} \rho_r(\mathbf{h}) \mathbf{T}_r,
\end{equation}
where $\mathbf{T}_r=\mathbf{a}_r \mathbf{a}_r^T$ and $\mathbf{a}_r$ is the $r$th column of $\mathbf{A}$.

Now, we propose a spatio-temporal extension of ($\ref{eqn:lmc1}$) under the Lagrangian framework.  
\nocite{wackernagel1998} \nocite{gelfand2002multivariate}

\begin{prop}\label{prop3}\label{expectedlagrangianlmc}
(Lagrangian Linear Model of Coregionalization) Let $\mathbf{V}_{r},\;r=1,\ldots,R$, be random vectors on $\mathbb{R}^d$ that characterize the different random advection velocities. If $\rho_{r}(\mathbf{h})$ is a valid univariate stationary correlation function on $\mathbb{R}^d$, then
\begin{equation}\label{spacetimelmc_expectation}
\mathbf{C}(\mathbf{h}, u)=\sum_{r=1}^{R} E_{\mathbf{V}_r}\left\{\rho_r(\mathbf{h}-u\mathbf{V}_r)\right\} \mathbf{T}_r
\end{equation}
is a valid spatio-temporal matrix-valued stationary covariance function on $\mathbb{R}^d \times \mathbb{R}$, for any $1\leq R\leq p$ and $\mathbf{T}_r=\mathbf{a}_r\mathbf{a}_r^T$ with $\sum_{r=1}^{R}\mathbf{T}_{r}=\mathbf{T}=\mathbf{A}\mathbf{A}^T$.
\end{prop}

\begin{figure}[!htbp]
 \centering
    \subfloat[Model (\ref{spacetimelmc_expectation}) with $\mathbf{V}_1=\mathbf{v}_1=(0.1,0.1)^T$ and $\mathbf{V}_2=\mathbf{v}_2=(0.1,-0.1)^T$ ]{ \includegraphics[scale=0.3]{fig3a.pdf} \label{fig:mod3covariance}}%
    \qquad
    \captionsetup[subfloat]{margin=-2cm}
    \subfloat[Model (\ref{spacetimelmc_expectation}) with $\mathbf{V}_1\sim\mathcal{N}_2\left\{\boldsymbol{\mu}=(0.1,0.1)^T,\boldsymbol{\Sigma}=\left(\protect\begin{smallmatrix}0.01 & 0.00009\\
    0.00009 & 0.00001\protect\end{smallmatrix}\right)\right\}$ and $\mathbf{V}_2\sim\mathcal{N}_2\left\{\boldsymbol{\mu}=(0.1,-0.1)^T,\boldsymbol{\Sigma}=\left(\protect\begin{smallmatrix}0.01 & 0\\
    0 & 0.00001\protect\end{smallmatrix}\right)\right\}$]{\includegraphics[scale=0.3]{fig3b.pdf}}%
     \caption{Heatmaps of the spatio-temporal Lagrangian LMC on a $31\times 31$ regular grid in a square $[-1.5,1.5]^2$ with purely spatial Mat\'{e}rn parameters: $\nu_{11}=0.5,\;\nu_{22}=1.5,\;a=0.23,\;\sigma_1^2=\sigma_2^2=1$, $\mathbf{T}_1=\left(\protect\begin{smallmatrix}0.9 & 0.1\\
    0.1 & 0.4\protect\end{smallmatrix}\right)$, and $\mathbf{T}_2=\left(\protect\begin{smallmatrix}0.1 & 0.2\\
    0.2 & 0.6\protect\end{smallmatrix}\right)$. (a) is the frozen field case, and (b) is the non-frozen field.}
   \label{fig:covariance_multiple_velocity}
   \end{figure}
   
   \begin{figure}[htb!]
 \centering
    \subfloat[Model (\ref{spacetimelmc_expectation}) with $\mathbf{v}_1=(0.1,0.1)^T$ and $\mathbf{v}_2=(0.1,-0.1)^T$ ]{ \includegraphics[scale=0.34]{fig4a.pdf}\label{fig:mod3covariance}}%
    \qquad
    \captionsetup[subfloat]{margin=-2cm}
    \subfloat[Model (\ref{spacetimelmc_expectation}) with $\mathbf{V}_1\sim\mathcal{N}_2\left\{\boldsymbol{\mu}=(0.1,0.1)^T,\boldsymbol{\Sigma}=\left(\protect\begin{smallmatrix}0.01 & 0.00009\\
    0.00009 & 0.00001\protect\end{smallmatrix}\right)\right\}$ and $\mathbf{V}_2\sim\mathcal{N}_2\left\{\boldsymbol{\mu}=(0.1,-0.1)^T,\boldsymbol{\Sigma}=\left(\protect\begin{smallmatrix}0.01 & 0\\
    0 & 0.00001\protect\end{smallmatrix}\right)\right\}$]{\includegraphics[scale=0.34]{fig4b.pdf}}
     \caption{Simulated realizations on the unit square for the covariance models in Figure \ref{fig:covariance_multiple_velocity}.}
    \label{fig:covariance_multiple_velocity_realizations}
   \end{figure}
   
The frozen $(\mathbf{V}_r=\mathbf{v}_r)$ and non-frozen Lagrangian LMC in (\ref{spacetimelmc_expectation}) are shown in Figures \ref{fig:covariance_multiple_velocity}(a) and \ref{fig:covariance_multiple_velocity}(b), along with their respective simulated spatio-temporal realizations (Figures \ref{fig:covariance_multiple_velocity_realizations}(a) and \ref{fig:covariance_multiple_velocity_realizations}(b)), when $p=R=2$. Unlike the frozen field model in (\ref{eqn:purelyspatialmatern}), the maximum covariance and  cross-covariance function values of the frozen Lagrangian LMC gradually decrease as the temporal lag increases. The effect of the different advection velocity vectors is seen by the way the covariances and cross-covariance are advected to different directions. The directions to which the maximum value of the covariances and cross-covariance shift are determined by the coefficient matrices $\mathbf{T}_1$ and $\mathbf{T}_2$. The non-frozen Lagrangian LMC dissipates more quickly compared to its frozen counterpart, even at small temporal lags, because of the added uncertainty in the random advection velocity vectors. The contours of the covariances and the cross-covariance, at nonzero temporal lags, depend on the different distributions of the random advection velocity vectors. Similarly to the frozen Lagrangian LMC, the coefficient matrices $\mathbf{T}_1$ and $\mathbf{T}_2$ determine the degree of influence in advection by each of the different distributions of the random advection velocity vectors.

\subsubsection{Nonstationary Cross-Covariance Functions}

In general, the validity of spatio-temporal Lagrangian cross-covariance functions with different advection velocity vectors for the marginals and the crosses is established by considering a multivariate spatio-temporal random field $\mathbf{Z}(\mathbf{s},t)$ such that $\mathbf{Z}(\mathbf{s},t)=\big\{\tilde{Z}_1\left(\mathbf{s}-\mathbf{v}_{11}t\right),\ldots,\tilde{Z}_p\left(\mathbf{s}-\mathbf{v}_{pp}t\right)\big\}^T$, where $\tilde{\mathbf{Z}}$ is a multivariate spatial stationary random field. 
\begin{prop}\label{corollary1}
Let $\mathbf{v}_{ii},\;i=1,\ldots,p$, be vectors on $\mathbb{R}^d$. If $\mathbf{C}^{S}(\mathbf{h})$ is a valid purely spatial matrix-valued stationary covariance function on $\mathbb{R}^d$, then $\mathbf{C}(\mathbf{h};t_1,t_2)=\left[C_{ij}^{S}\left\{\mathbf{h}-\overline{\mathbf{v}}_{ij}u+(\mathbf{v}_{jj}-\mathbf{v}_{ii})m\right\}\right]_{i,j=1}^{p}$ is a valid spatio-temporal matrix-valued nonstationary covariance function on $\mathbb{R}^d \times \mathbb{R}$ where $\overline{\mathbf{v}}_{ij}=\frac{\mathbf{v}_{ii}+\mathbf{v}_{jj}}{2},\;i,j=1,\ldots,p,$ $u=t_2-t_1$, and $m=\frac{t_1+t_2}{2}$.
\end{prop}

The cross-covariance function in Proposition \ref{corollary1} is no longer stationary in time; it depends on the midpoint of time points. In the univariate setting, covariance functions of this type are known as ``locally stationary covariance functions": their technical details are presented in \citet{genton2004time}. The model in Proposition \ref{corollary1} warrants a separate investigation on its properties and estimation techniques that are note covered in this paper. When $\mathbf{v}=\mathbf{v}_{11}=\cdots=\mathbf{v}_{pp},$ we get the multivariate frozen field model in Equation (\ref{eqn:proposed2}). The conditions for the validity of the non-frozen version of Proposition \ref{corollary1} are difficult to characterize, even when $p=2$. 


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Multivariate Taylor's Hypothesis}

One interesting property of the multivariate stationary frozen field models presented in the earlier part of this section is that the advection velocity vector links their purely spatial and purely temporal margins. This special property was first defined by \citet{taylor1938spectrum}, in the univariate setting. A univariate spatio-temporal stationary covariance function $C(\mathbf{h},u)$ on $\mathbb{R}^d\times \mathbb{R}$ satisfies Taylor's hypothesis if there exists an advection velocity vector $\mathbf{v}\in\mathbb{R}^d$ such that 
\begin{equation}\label{eqn:uni_TH}
C(\mathbf{0},u)=C(u\mathbf{v},0),\quad u\in \mathbb{R}.
\end{equation}
Here, $u\mathbf{v}$ can be regarded as the position traveled to by the random field for the temporal duration $u$; see \cite{li2009statistical} for an application to precipitation fields. Extending this to the multivariate case, we say that a spatio-temporal stationary cross-covariance matrix-valued function $\mathbf{C}(\mathbf{h},u)=\left\{C_{ij}(\mathbf{h},u)\right\}_{i,j=1}^{p}$ on $\mathbb{R}^d\times \mathbb{R}$ satisfies the multivariate Taylor's hypothesis if there exist advection velocity vectors $\mathbf{v}_{ij}\in\mathbb{R}^d$ such that
\begin{equation}\label{eqn:TH}
C_{ij}(\mathbf{0},u)=C_{ij}(u\mathbf{v}_{ij},0),\quad u\in \mathbb{R},
\end{equation}
for $i,j=1,\ldots,p.$ The following spatio-temporal stationary cross-covariance functions, among others, satisfy the multivariate Taylor's hypothesis (\ref{eqn:TH}) exactly:
\begin{compactenum}
\item Multivariate stationary frozen field models with single advection velocity vector.

\item Separable models $\mathbf{C}(\mathbf{h},u)=\left\{C_{ij}(\mathbf{h},u)\right\}_{i,j=1}^{p}$ under different types of separability identified by \citet{apanasovich2010cross}: 
\begin{compactenum}
\item Full separability:
$C_{ij}(\mathbf{h},u)=\rho_{ij}C(\mathbf{h})C(u)$, $\mathbf{h}\in \mathbb{R}^d$, $\;u\in \mathbb{R}$,
where $C(\mathbf{h},u)$ is a valid univariate spatio-temporal stationary covariance function for which the spatial and temporal margins are separable, and for which $\rho_{ij}=\text{corr}(Z_i,Z_j)$ is the nonspatial correlation between variables $i$ and $j$, with $\mathbf{v}_{ij}=(1,0,\ldots,0)^T \in \mathbb{R}^d$, $i,j=1,\ldots,p$. 
\item Spatio-temporal partial separability:
$C_{ij}(\mathbf{h},u)=C_{ij}(\mathbf{h})C_{ij}(u)$, $\mathbf{h}\in \mathbb{R}^d$, $u\in \mathbb{R}$,
with $\mathbf{v}_{ij}=(1,0,\ldots,0)^T \in \mathbb{R}^d$, $i,j=1,\ldots,p$. 
\item Variable separability:
$C_{ij}(\mathbf{h},u)=\rho_{ij}C(\mathbf{h},u)$, $\mathbf{h}\in \mathbb{R}^d$, $u\in \mathbb{R}$,
where $C(\mathbf{h},u)$ is a univariate spatio-temporal stationary covariance function such that the spatial and temporal margins are nonseparable, and $C(\mathbf{h},u)$ satisfies the univariate Taylor's hypothesis with $\mathbf{v}$, with $\mathbf{v}_{ij}=\mathbf{v},\;$ for $i,j=1,\ldots,p$. Examples of $C(\mathbf{h},u)$ and their corresponding advection velocity vector $\mathbf{v}$ are listed in \citet{gneiting2006geostatistical}.
\end{compactenum}

\item The spatio-temporal Gneiting-Cauchy cross-covariance functions 
\begin{equation}\label{eqn:gneitingcauchy}
C_{ij}(\mathbf{h},u)=\frac{\rho_{ij}\sigma_{i}\sigma_{j}}{(\alpha |u|^{2a}+1)^{\tau}}\left\{1+\frac{r_{ij}\|\mathbf{h}\|^{2\lambda}}{(\alpha|u|^{2a}+1)^{\lambda b/2}}\right\}^{-\nu_{ij}/\lambda},\quad \mathbf{h}\in \mathbb{R}^d,\;u\in \mathbb{R},
\end{equation}
where $\alpha>0,\;0<a\leq 1,\;0\leq b\leq 1,\;0<\lambda\leq 2,\;\nu_{ij},r_{ij}>0$ for $i,j=1,\ldots,p$. For further specifications to ensure validity of $\mathbf{C}(\mathbf{h},u)$, see \citet{bourotte2016flexible}. When $\lambda=a$ and $\tau=\nu_{ij}/a$, (\ref{eqn:gneitingcauchy}) admits the multivariate Taylor's hypothesis if $\mathbf{v}_{ij}=\left\{(\alpha/r_{ij})^{1/(2a)},0,\ldots,0\right\}^T\in \mathbb{R}^d$ for $i,j=1,\ldots,p$.
\end{compactenum}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Weighted Least Squares Estimation}\label{sec:estimation}

The most important parameter in any spatio-temporal Lagrangian cross-covariance function is the advection velocity vector. Hence, an efficient estimation procedure should be devised in order to estimate the parameter that transforms a purely spatial cross-covariance function into a spatio-temporal Lagrangian cross-covariance function.

Weighted Least Squares (WLS) by \citet{cressie1985fitting} is an estimation method less burdensome, computationally, than the maximum likelihood estimation (MLE), when dealing with spatio-temporal data. WLS requires a nonparametric estimate of the covariance function, the empirical covariance function. \citet{gneiting2006geostatistical} demonstrated that, in the univariate setting, the advection velocity vector could be estimated via WLS. MLE is computationally intensive, since it requires the evaluation of the determinant and inverse of an $np\times np$ covariance matrix, where $n$ is the number of spatio-temporal locations and $p$ the number of variables. An estimation via maximizing the likelihood is not desirable when either $n$ or $p$ is large. Therefore, we use WLS in order to estimate the parameters of cross-covariance functions under the Lagrangian framework. Additionally, for numerical stability, we compute the empirical marginal variances, and estimate the parameters of the standardized components via WLS.

There are different ways to perform estimation under WLS. One can either do a joint WLS where all the parameters are estimated together, or do a multi-step WLS where groups of parameters are estimated sequentially. The former becomes problematic when the number of parameters is large. The latter effectively reduces the computational burden and ensures the convergence of subsets of parameters. The multi-step WLS can be done as follows: for each variable $i=1,\ldots,p,$ find the vector $\widehat{\boldsymbol{\theta}}\in \mathbb{R}^M$, where $M$ is the total number of marginal purely spatial parameters, that  minimizes the objective function
\begin{equation}\label{eqn:objective_function1}
\mathcal{Q}(\boldsymbol{\theta})=\sum_{i=1}^{p}\sum_{j=1}^{p} \sum_{k \in K}\left\{\frac{\hat{C}_{ij}(\mathbf{h}_{k},0)-C_{ij}(\mathbf{h}_{k},0|\boldsymbol{\theta})}{1-C_{ij}(\mathbf{h}_{k},0|\boldsymbol{\theta})}\right\}^2
\end{equation}
with respect to all marginal purely spatial parameters. Second, given the previously estimated marginal purely spatial parameters $\widehat{\boldsymbol{\theta}}$, find $\widehat{\rho}_{ij} \in \mathbb{R}$, for $i,j=1,\ldots,p$, and $i\neq j$, that minimize 
\begin{equation}\label{eqn:objective_function2}
\tilde{\mathcal{Q}}(\rho_{ij})=\sum_{k\in K}\left\{\frac{\hat{C}_{ij}(\mathbf{h}_{k},0)-C_{ij}(\mathbf{h}_{k},0|\rho_{ij}, \widehat{\boldsymbol{\theta}})}{1-C_{ij}(\mathbf{h}_{k},0|\rho_{ij}, \widehat{\boldsymbol{\theta}})}\right\}^2.
\end{equation}
with respect to the cross-correlation parameter, $\rho_{ij} \in \mathbb{R}$. Finally, fixing the purely spatial parameters to the estimated values in the previous steps, find the vector $\widehat{\mathbf{v}}\in \mathbb{R}^{d}$, assuming single constant advection velocity vector, that minimizes 
\begin{equation}\label{estimatingv}
\check{\mathcal{Q}}(\mathbf{v})=\sum_{i=1}^{p}\sum_{j=1}^{p} \sum_{k\in K}\sum_{l\in L}\left\{\frac{\hat{C}_{ij}(\mathbf{h}_{k},u_l)-C_{ij}(\mathbf{h}_{k},u_l|\mathbf{v}, \widehat{\boldsymbol{\theta}}, \widehat{\rho}_{ij})}{1-C_{ij}(\mathbf{h}_{k},u_l|\mathbf{v}, \widehat{\boldsymbol{\theta}}, \widehat{\rho}_{ij})}\right\}^2,
\end{equation}
with respect to the advection velocity vector parameters $\mathbf{v}=(v_x,v_y)^T$. The objective function in (\ref{estimatingv}) is also used to estimate the parameters of the single random advection velocity $\mathbf{V}$ by minimizing $\check{\mathcal{Q}}(\mathbf{V})$ with respect to the parameters $\left(\boldsymbol{\mu},\boldsymbol{\Sigma}\right)$, $\boldsymbol{\mu}\in  \mathbb{R}^d$ and $\boldsymbol{\Sigma}\in  \mathbb{R}^{d\times d}$. Similarly, the parameters of the frozen and non-frozen Lagrangian LMC are estimated by minimizing (\ref{estimatingv}) with respect to $\tilde{\mathbf{v}}=\left(\tilde{\mathbf{v}}_1^T,\ldots,\tilde{\mathbf{v}}_R^T\right)^T$, and $\left\{\left(\boldsymbol{\mu}_1,\boldsymbol{\Sigma}_1\right),\ldots, \left(\boldsymbol{\mu}_R,\boldsymbol{\Sigma}_R\right)\right\}$, respectively. Here $\widehat{C}_{ij}(\mathbf{h}_k,0)$ and $\widehat{C}_{ij}(\mathbf{h}_k,u_l)$ are the empirical purely spatial and empirical spatio-temporal stationary cross-correlation functions, respectively, at spatial lag $\mathbf{h}_k,\; k \in K$, and temporal lag $u_l,\; l \in L$; $C_{ij}(\mathbf{h}_k,0|\boldsymbol{\theta}, \rho_{ij})$ and $C_{ij}(\mathbf{h}_k,u_l|\boldsymbol{\theta}, \rho_{ij}, \mathbf{v})$ are the corresponding values of the parametric purely spatial and parametric spatio-temporal stationary cross-correlation functions, respectively. The sets $K$ and $L$ control which spatial and temporal lags, $\mathbf{h}$ and $u$, are included in the computation of the objective function. Ideally, it should include all lags $\mathbf{h}$ and $u$ for which there is non-negligible dependence and some for which there is negligible dependence. The objective functions (\ref{eqn:objective_function1})-(\ref{estimatingv}) are the multivariate extension of the objective function recommended by \citet{gneiting2002}, which give more weight to large correlations and cross-correlations. 

In the applications presented in Sections 4 and 5, the objective functions are minimized using the built-in function \emph{\tt optim} with quasi-Newton method ``BFGS" in \textsf{R}. To ensure that a single global minimum of the objective function is achieved, the optimization is repeated 100 times, with random initial values starting from the empirical estimates of the parameters. 

Through an extensive simulation study comparing the performances of the joint WLS with the multi-step WLS, the latter gave better estimates for all the parameters, i.e., the differences between the median parameter estimates and their corresponding true parameter values were smaller under the multi-step WLS compared to those obtained using the joint WLS (see Supplementary Material). Therefore, we adopt this method for estimation.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Application to Particulate Matter Data}\label{sec:application}

Pollutants are influenced by the presence of wind and are advected accordingly to neighboring sites. Hence, it is physically reasonable to use Lagrangian cross-covariance functions to model spatial and temporal dependencies. As the pollutants at the lower levels of the atmosphere are transported by wind, which generally moves along a certain direction, the marginal covariances and cross-covariances between different altitudes are expected to be stronger in certain directions, as the temporal lag increases. 

\subsection{Saudi Particulate Matter Dataset}\label{sec:application_data}

\begin{figure}[htb!]
 \centering
\quad \quad\subfloat[Site locations]{\includegraphics[scale=0.55]{fig5a.pdf}}%
  \; \subfloat[Original coordinates]{\includegraphics[scale=0.35]{empspacetime.pdf}}%
     \quad \quad \quad \quad   
    \subfloat[After rotation and stretching of original coordinates]{\includegraphics[scale=0.35]{ROTATEDempspacetime.pdf}}%
    \subfloat[Fitted M1]{\includegraphics[scale=0.35]{fig5d.pdf}}
    \caption{\small (a) Locations of the 100 sites in Saudi Arabia. Sites used in estimation are in orange, while validation sites are in green. The groupings for estimation and validation are chosen at random. Minimum distance between sites is: 111.6 km. Maximum distance between sites is: 4180 km. (b) Empirical spatio-temporal correlation of 80 sites (in orange) on the map. First row: $\hat{C}_{11}$ of PM at 1000 hPa. Second row: $\hat{C}_{22}$ of PM at 975 hPa. Third row: Cross-correlation between PM at 1000 hPa and PM at 975 hPa. There is a suspected anisotropy for $\hat{C}_{11}$, $\hat{C}_{22}$, and $\hat{C}_{12}$. (c) Empirical spatio-temporal correlation after correcting for anisotropy. Minimum distance between sites is: 103 km. Maximum distance between sites is: 3800 km. (d) Fitted spatio-temporal correlations and cross-correlation of model M1.}
    \label{fig:saudi_map}
\end{figure}

The dataset used in the present study was obtained from \href{https://goldsmr5.gesdisc.eosdis.nasa.gov/data/MERRA2/}{NASA Earthdata} and contains observations of particulate matter (PM 2.5) measured every 3 hours at 1000 hPa and 975 hPa, throughout Saudi Arabia. To ensure that the data are stationary in time, we only used January data at 100 sites, over the period 1980-2004. Spatial stationarity is already exhibited by the bivariate dataset, see Supplementary Material. Site locations are shown in Figure \ref{fig:saudi_map}. 

The spatio-temporal modeling is carried out on the standardized $\log $ PM measurements, i.e., let $Z_1(\mathbf{s},t)$ be the standardized $\log $ PM at 1000 hPa, and $Z_2(\mathbf{s},t)$ at 975 hPa, at spatial location $\mathbf{s} \in \mathbb{R}^d$ and time $t\in\mathbb{R}$. Other transformations were considered, but the aforementioned proved to be the best approach to satisfy Gaussianity and stationarity assumptions. 

Figure \ref{fig:saudi_map}(b) shows the empirical spatio-temporal marginal and cross-correlations from the 80 sites used for estimation, shown in Figure \ref{fig:saudi_map}(a) as orange dots on the map. The empirical spatio-temporal marginal and cross-correlations persist, even between sites with a large separation distance. As the temporal lag increases, there is clear evidence of advection of PM at 1000 hPa and 975 hPa. This pattern only persists until the first temporal lag (after 3 hours), and then disappears. Except for the empirical cross-correlation at the bottom row, the maximum empirical marginal correlations at $u=0$ occur at the origin, i.e., $\mathbf{h}=\mathbf{0}$, as expected, with values decreasing with increasing lag in time. As for the empirical cross-correlation between $Z_1$ and $Z_2$ at $u=0$, their maximum occurs at $\mathbf{h}\neq\mathbf{0}$. This property was studied, among others, by \citet{apanasovich2010cross} and \citet{li2011approach}, who showed that simply adding a variable asymmetry parameter to capture this feature resulted in valid stationary cross-correlation models.

Figure \ref{fig:saudi_map}(b) also suggests the presence of a small anisotropy, possibly due to the limited spatial domain under analysis. Although enlarging the domain corrects some of the anisotropy, it does not totally disappear. Since the proposed models in Section 2 only work in the spatial isotropic case at $u=0$, we first correct the anisotropy by rotating and shrinking the original coordinate system of the random field. Based on Figure~\ref{fig:saudi_map}(c), after rotation and shrinking of the original coordinates, the maximum of the empirical marginal correlations still occur at $\mathbf{h}=\mathbf{0}$ whereas the position of the maximum empirical cross-correlation has shifted. From here on, we perform the analysis of the empirical spatio-temporal correlations and cross-correlation, once the anisotropy has been corrected.

Also shown in Figure~\ref{fig:saudi_map}(c), as $u$ increases in the new coordinate system, the maximum empirical marginal correlations for $Z_1$ and $Z_2$ shift to the West/Southwest direction.  Although not easily detected visually from the plots, the maximum of their empirical cross-correlation also moves to the West/Southwest direction. This suggests that the assumption of the single advection velocity vector is sensible for the bivariate dataset under study. 

From Figure~\ref{fig:saudi_map}(c) alone, we can see that the multivariate frozen field assumption does not hold. Otherwise, the empirical correlation and cross-correlation values would be preserved, even as the temporal lag increases (see Figure~\ref{fig:covariance_single_velocity}(a)). Instead, the empirical correlations and cross-correlation decay with increasing temporal lag. This means that either we augment the multivariate frozen field model by including a factor that captures the dissipation over time, or we use the non-frozen random advection velocity vector model. In Figure~\ref{fig:empiricaldistributionofV}, we perform a visual validation of the violation of the multivariate frozen field assumption. Figure~\ref{fig:empiricaldistributionofV}(a) shows the empirical spatio-temporal correlations and cross-correlation at $u=1$, for 3 out of 124 $(8 \text{ observations per day } \times 31 \text{ days} / 2)$ sub-periods in January. These sub-periods are chosen such that they are disjoint, and that each contains spatial observations for two consecutive time points. The arrows indicate the position of the shift of the maximum empirical correlations and cross-correlations from $u=0$. Because the maximum empirical marginal correlations are observed at $\mathbf{h}=\mathbf{0}$ and $u=0$, the tails of the arrows are positioned at the origin. On the other hand, for the empirical cross-correlation, since there is variable asymmetry, the tails of the arrows at the bottom row plots of Figure~\ref{fig:empiricaldistributionofV}(a) are not positioned at the origin. These arrows serve as empirical estimates of the advection velocity vector. The empirical estimates were computed via the time delay method, a widely used estimation technique for the advection velocity vector; see \citet{seed1999space}, \citet{inoue2012spatio}, \citet{li2009statistical}, \citet{jamaly2018robust}, and \citet{russo2018spatial} for a detailed discussion of this type of estimation procedure. This was done by finding the spatial lag at which the maximum empirical correlations and cross-correlation occur. For every sub-period, we obtained three empirical estimates of the advection velocity vector. The plots of the components of these empirical estimates are presented in Figure 6(b). This figure shows that there is some variability of the advection velocity vector, which gives us more reasons to believe that, indeed, the multivariate frozen field assumption does not hold, and that the dissipation over time is most likely caused by the randomness of the advection velocity vector.
\begin{figure}[t!]
 \centering
 \subfloat[Empirical spatio-temporal correlations and cross-correlation at u = 1 for 3 out of 124 sub-periods in January.]{\includegraphics[scale=0.35]{fig6a.pdf}}%
 \quad
    \subfloat[Empirical distribution of $\mathbf{V}$. The coordinates are in $\times 10^{3}$ km.]{\includegraphics[scale=0.65]{fig6b.pdf}}%
    \caption{\small The location of the arrowheads in (a) are plotted as gray points in (b). The black dashed contours in (b) delineate the 0.5 and 0.95 probability regions. The empirical estimate of the advection velocity vectors that are plotted is computed as $\frac{\mathbf{h}_{\max}^{ij,u}}{u}$, such that $\mathbf{h}_{\max}^{ij,u}$ is the spatial lag where $\smash{\displaystyle\max_{\mathbf{h}}}\; \left\{C_{ij}(\mathbf{h},u)\right\}$ occurs for  $i,j=1,2$. We retrieve three empirical estimates of the advection velocity vector per sub-period, one for each marginal correlation and another one for their cross-correlation. Since, in our application we only consider up to $u=1$, the points are simply the positions of $\smash{\displaystyle\max_{\mathbf{h}}}\; C_{ij}(\mathbf{h},1)$ for all $i,j=1,2$. The solid purple and light green contours are the fitted distribution of the random advection velocity vectors of models M1 and M3. }
    \label{fig:empiricaldistributionofV}
\end{figure}


\subsection{Models}

We fit five different bivariate spatio-temporal stationary covariance functions with Mat\'{e}rn spatial margins. The first three models proposed in Section 2 are listed, with decreasing complexity and additional features. The last two models are other competing bivariate spatio-temporal stationary covariance functions in the literature. The five models are:
\begin{compactitem}
\item M1: Parsimonious bivariate spatio-temporal Lagrangian Mat\'{e}rn with single random advection velocity vector and variable asymmetry parameter $\boldsymbol{\kappa}\in \mathbb{R}^d$. This is the model in Equation (\ref{eqn:closedformmultivariatematern}), with a common spatial scale parameter $a$ and $\nu_{ij}=\frac{\nu_{ii}+\nu_{jj}}{2}$, for $i,j=1,2$. The additional variable asymmetry parameter is explained in the next model, M2.

\item M2: Parsimonious bivariate spatio-temporal Lagrangian Mat\'{e}rn with single advection velocity vector with variable asymmetry parameter $\boldsymbol{\kappa}\in \mathbb{R}^d$: $\mathbf{C}(\mathbf{h},u)=\left\{\exp(-\theta_{ij}u)C_{ij}(\mathbf{h},u)\right\}_{i,j=1}^{2}$ and
\begin{equation}
\begin{array}{r@{}l}
    C_{ii}(\mathbf{h},u) &{}= \sigma_{i}^{2}\frac{2^{1-\nu_{ii}}}{\Gamma(\nu_{ii})}\left(\frac{\|\mathbf{h}-u\mathbf{v}\|}{a}\right)^{\nu_{ii}}\mathcal{K}_{\nu_{ii}}\left(\frac{\|\mathbf{h}-u\mathbf{v}\|}{a}\right),\\
    C_{ij}(\mathbf{h},u)&{}= \rho_{ij} \sigma_{i}\sigma_{j}\frac{2^{1-(\nu_{ii}+\nu_{jj})/2}}{\Gamma\left\{(\nu_{ii}+\nu_{jj})/2\right\}}\left(\frac{\|\tilde{\mathbf{h}}-u\mathbf{v}\|}{a}\right)^{(\nu_{ii}+\nu_{jj})/2}\mathcal{K}_{(\nu_{ii}+\nu_{jj})/2}\left(\frac{\|\tilde{\mathbf{h}}-u\mathbf{v}\|}{a}\right),
\end{array}
\end{equation}
where $\tilde{\mathbf{h}}=\mathbf{h}+\boldsymbol{\kappa}$ if $i<j$, and $\tilde{\mathbf{h}}=\mathbf{h}-\boldsymbol{\kappa}$ if $i>j$, and the time-dependent exponential factor captures the dissipation over time, where $\theta_{ij}\geq 0$ and $\theta_{ij}=\frac{\theta_{ii}+\theta_{jj}}{2}$, for $i,j=1,2$. Here, $\boldsymbol{\kappa}$ quantifies the degree of variable asymmetry. This modeling approach was first developed by \citet{li2011approach}. Here, we include this parameter since based on Figure~\ref{fig:saudi_map}, the maximum empirical cross-correlation at $u=0$ occurs at $\mathbf{h}\neq \mathbf{0}.$
 
\item M3: Bivariate Lagrangian LMC with random advection velocity vectors: 
\begin{multline*}
\mathbf{C}(\mathbf{h}, u)=\frac{1}{\sqrt{|\mathbf{I}_d+u^2\tilde{\boldsymbol{\Sigma}}_1|}}\mathcal{M}\left\{\left(\mathbf{h}-u\tilde{\boldsymbol{\mu}}_1\right)^T\left(\mathbf{I}_d+u^2\tilde{\boldsymbol{\Sigma}}_1\right)^{-1}\left(\mathbf{h}-u\tilde{\boldsymbol{\mu}}_1\right);\tilde{a}_1,\nu_{11}\right\} \mathbf{T}_1  \\
+\frac{1}{\sqrt{|\mathbf{I}_d+u^2\tilde{\boldsymbol{\Sigma}}_2|}}\mathcal{M}\left\{\left(\mathbf{h}-u\tilde{\boldsymbol{\mu}}_2\right)^T\left(\mathbf{I}_d+u^2\tilde{\boldsymbol{\Sigma}}_2\right)^{-1}\left(\mathbf{h}-u\tilde{\boldsymbol{\mu}}_2\right);\tilde{a}_2,\nu_{22})\right\} \mathbf{T}_2,
\end{multline*}
where $\mathcal{M}(\mathbf{h};\tilde{a}_r,\nu_{rr})$ is the univariate Mat\'e{r}n correlation with scale and smoothness parameters $\tilde{a}_r$ and $\nu_{rr}$, respectively, and $\tilde{\mathbf{V}}_{r}\sim\mathcal{N}_2(\tilde{\boldsymbol{\mu}}_r,\tilde{\boldsymbol{\Sigma}}_r),\;r=1,2$, are random advection velocity vectors. The univariate Lagrangian covariance models listed above were first introduced by \citet{schlather2010some}.

\item M4: Bivariate spatio-temporal Gneiting-Mat\'{e}rn with a compactly supported spatio-temporal Lagrangian stationary cross-covariance function. This model is a linear combination of a fully symmetric bivariate spatio-temporal stationary covariance function and an asymmetric bivariate spatio-temporal stationary covariance function of the form: 
\begin{equation}\label{eqn:m6}
\mathbf{C}_A(\mathbf{h},u)=(1-\Lambda)\mathbf{C}_{NS}(\mathbf{h},u)+\Lambda \mathbf{C}_{T}(\mathbf{h},u) ,
\end{equation}
where $\mathbf{C}_T$ is an asymmetric stationary covariance function (see below) and $\mathbf{C}_{NS}(\mathbf{h},u)=\left\{C_{ij}(\mathbf{h},u)\right\}_{i,j=1}^{2}$ is a nonseparable symmetric stationary covariance function with entries from a bivariate spatio-temporal Gneiting-Mat\'{e}rn class found in \citet{bourotte2016flexible}:
\begin{equation}\label{eqn:bivariategneitingmatern}
C_{ij}(\mathbf{h},u)=\frac{\rho_{ij}}{\alpha |u|^{2r}+1}\mathcal{M}\left\{\frac{\mathbf{h}}{(\alpha |u|^{2r}+1)^{b/2}};a,\nu_{ij}\right\},\quad i,j=1,2.
\end{equation}
Additional temporal parameters include $\alpha>0$ and $r\in (0,1]$, which describe the temporal range and smoothness, respectively. The parameter $b\in [0,1]$, also called the ``nonseparability parameter", represents the strength of the spatio-temporal interaction. We define $\mathbf{C}_{T}(\mathbf{h},u)=\left\{C_{ij}(\mathbf{h},u)\right\}_{i,j=1}^{2}$, where $C_{ij}(\mathbf{h},u)$ is the Askey taper introduced by \citet{roh2015multivariate}:
\begin{equation}
C_{ij}(\mathbf{h},u)=\beta_{ij}\left(1-\frac{1}{c}\|\mathbf{h}-u\mathbf{v}\|\right)_{+}^{\psi+\gamma_{ij}},
\end{equation}
where $(\cdot)_{+}=\max(\cdot,0)$. Here, $c>0$ is the taper length, $\gamma_{12}=\gamma_{21}\leq \frac{1}{2}(\gamma_{11}+\gamma_{22})$, $\psi\geq \left \lfloor{\frac{d}{2}}\right \rfloor+2$, where $\left \lfloor{\cdot}\right \rfloor$ is the floor function, and $\beta_{ij}$ is a function of $\psi$ and $\gamma_{ij}$ \citep{roh2015multivariate}. To keep the number of parameters to be estimated minimal, we set $\beta_{11}=\beta_{22}=1$.
%We set $\nu=3$, $\beta_{ii}=1$, for $i=1,2$ and $\gamma_{ij}=\gamma=1$.

Lastly, the temporal asymmetry parameter $\Lambda\in [0,1]$ represents the degree of lack of symmetry in time. This temporal asymmetry parameter is key to investigate the effects of this lack of symmetry on multivariate spatio-temporal predictions with model misspecification by simulations based on (\ref{eqn:m6}) with varying values of $\Lambda$ (Section \ref{sec:simulation}).

\item M5: Bivariate spatio-temporal Gneiting-Mat\'{e}rn. This model follows (\ref{eqn:m6}), with $\Lambda=0$. %We set $\alpha=1,\; b=r=0.5$.
\end{compactitem}

To correct the anisotropy, we introduce a rotation matrix $\mathbf{R}$ with entries 
\begin{equation}
\mathbf{R}=\begin{pmatrix}
r_x\cos\Theta & r_x\sin\Theta \\
-r_y\sin\Theta & r_y\cos\Theta\\
\end{pmatrix},
\end{equation}
where $\mathbf{r}=(r_x,r_y)^T$ and $\Theta$ are the anisotropic ratio and anisotropic angle parameters, respectively. All the models listed above are evaluated at the new spatial coordinate system, so that, if $\check{\mathbf{h}}$ is the original spatial coordinate, the covariance function is then evaluated at $\mathbf{h}=\mathbf{R}\check{\mathbf{h}}$. The validity of this type of models was previously established by \citet{hewer2017matern}.


\subsection{Results}

From Figure 5(c), we find that significant correlations and cross-correlation persist until $u=1$. Thus, we model only for $u=0,1$. As a consequence, we do not need to estimate the parameter $r$ for the model M4.

Figure~\ref{fig:empirical_plots_fit} shows the empirical and fitted correlations and cross-correlation plots, at temporal lag zero of the bivariate PM dataset from 80 sites in Saudi Arabia, chosen for estimation. The parameters were estimated using the multi-step WLS. A summary of the parameter estimates, using the different models is shown in Table 1.

The rotation matrix $\mathbf{R}$ significantly reduces the anisotropy of the random field, as seen in Figure~\ref{fig:saudi_map}(c), with estimates $\hat{\Theta}=116.9$ and $\hat {\bf r}=(-1.134,\, -0.862)^T$.
The nonzero estimate of the anisotropic angle, $\hat{\Theta}$, tells us that the anisotropy cannot be neglected.

As mentioned previously, the maximum empirical cross-correlation does not occur at $\mathbf{h}=\mathbf{0}$, but at $\boldsymbol{\kappa}=(704.4,205.7)^T$ km, estimated from models M1 and M2. The additional variable asymmetry parameter, $\boldsymbol{\kappa}$, certainly improves the fit, based on the value of $Q(\boldsymbol{\theta})$ obtained with the models M1 and M2 (Table 2).

Estimates of the advection velocity vector, using M2 and M4, and the estimate of the mean of the random advection velocity vector, using M1, show that the movement direction of the bivariate random field is indeed in the West/Southwest direction. Moreover, M1 estimated positively correlated components of the single random advection velocity vector, with a correlation $\hat{\Sigma}_{12}/\sqrt{\hat{\Sigma}_{11}\hat{\Sigma}_{22}}=0.373$.

The assumption made earlier that the spatio-temporal dependence persists only until $u=1$ is not unsubstantiated, based on the large estimate of the temporal scale parameter, $\hat{\alpha}=0.999$, for the models M4 and M5. A high value of $\alpha$ means that the correlations and cross-correlation at nonzero temporal lags quickly decline. Coupled with the spatio-temporal dependence parameter estimate, $\hat{b}$, which is very close to 1, M4 and M5 show that the spatio-temporal dependencies are non-negligible but with fast decline. Moreover, the estimates of the variances of the components of the single random advection velocity vector, using the model M1, indicate high marginal variability of the components, with $\hat{\Sigma}_{11}=1681$ km and $\hat{\Sigma}_{22}=5152$ km.

\begin{figure}[t!]
 \centering
\includegraphics[scale=0.87]{fig7.pdf}
    \caption{\small Plots of empirical and fitted purely spatial correlations and cross-correlation against distance at $u=0$ after rotation and shrinking of original coordinates. The curves for M1 and M2 in the marginals almost coincide with the curves of M4 and M5 which is expected based on the parameter estimates. }
    \label{fig:empirical_plots_fit}
\end{figure}

Although there is an apparent advection for both the empirical marginal correlations and the cross-correlation, as shown in Figure~\ref{fig:saudi_map}(c), M4 failed to detect this. We got an almost zero estimate for the temporal asymmetry parameter, i.e., $\hat{\Lambda}=0.001,$ leaving us with an almost equal fit for M4 and M5, based on their in-sample scores and out-of-sample prediction scores (Table~2), as these two models are almost similar when $\Lambda\rightarrow 0$. This undetected advection by M4 may be due to the differing magnitudes of shift of the maximum correlations and cross-correlation. Although $\smash{\displaystyle\max_{\mathbf{h}}}\;\hat{C}_{11}(\mathbf{h},1)$ is clearly advected to the West/Southwest with a huge shift, $\smash{\displaystyle\max_{\mathbf{h}}}\;\hat{C}_{22}(\mathbf{h},1)$ and $\smash{\displaystyle\max_{\mathbf{h}}}\;\hat{C}_{12}(\mathbf{h},1)$ seem to not be advected that much. Because the $\hat{C_{ij}}$s are equally weighted in the objective function of multi-step WLS for $i,j=1,2$ (see Equation (\ref{eqn:objective_function1})), M4 estimated a random field with almost no advection.

In M2, the nonzero estimates of the dissipation parameters $\hat \theta_1=0.704$ and $\hat \theta_2=0.444$ show the importance of including the dissipation parameters to capture the decrease both in the correlations and in the cross-correlation as $u$ increases. 

\begin{table}[t!]
\centering
\caption{\small Parameter estimates using different models on the Saudi particulate matter data.}
\caption*{\small Spatial Parameters}
\scalebox{0.8}{
\begin{tabular}{ccccccccccccccc} 
\toprule
Model &  & $\hat{\nu}_{11}$ & $\hat{\nu}_{22}$ & $\hat{a}$ & $\hat{\rho}_{12}$ & $\hat{\boldsymbol{\kappa}}$ (km) & $\hat{\tilde{a}}_1$& $\hat{\tilde{a}}_2$ & $\hat{\mathbf{A}}$ \\
 \midrule
M1 \& M2 & &  3.218 & 3.736 & 794.8 & 0.59  & $(704.4, 205.7)^T$ &- &- &- \\ 
M3 & & 4.095 &  2.337 & -  & -  & -&  417 & 1098  &$\left(\protect\begin{matrix}0.838 & 0.545\\
0 & 0.999\protect\end{matrix}\right)$ \\
M4 & & 3.757 & 4.394 & 723.9 & 0.55 &- &- &-&-\\ 
M5 & & 3.218 & 3.736 & 794.8 & 0.52 &- &- &- &-\\   %-126.1124  -58.4599
    \bottomrule   
    \end{tabular}
}
\bigskip
\caption*{\small Temporal Parameters}
\scalebox{0.8}{
\begin{tabular}{cccccccccccc}
\toprule
\multirow{4}{*}{} Model & &  {$\hat{\alpha}$} & {$\hat{b}$} & $\hat{\Lambda}$  & {$\hat{c}$} &{$\hat{\psi}$} &$\hat{\gamma}_1$& $\hat{\gamma}_2$& $\hat{\theta}_1$ & $\hat{\theta}_2$ \\
 \midrule
M1 & & - & - & -  & - & -& -  & -& -& -\\
M2 & & - & - & - & - & - & - & -  & 0.704  &   0.444 \\
M3 & & - & - & -& -  & - & - & - &-   &- \\
M4 & & 0.999 & 0.936 & 0.001 & 1948 & 5.846 & 0.499 & 0.674 & - & - \\
M5 & &  0.999 & 0.947 &- & - & -& -&- & - & - \\
\bottomrule 
\end{tabular}
}
\label{tab:estimates}
\bigskip
\caption*{\small Advection Parameters}
\scalebox{0.65}{
\begin{tabular}{ccccccccccccccccccccc}
\toprule
\multirow{4}{*}{} Model & & $\hat{\tilde{\boldsymbol{\mu}}}_1$ (km) & $\hat{\tilde{\boldsymbol{\mu}}}_2$ (km) & {$\hat{\tilde{\boldsymbol{\Sigma}}}_1$}  (km) & {$\hat{\tilde{\boldsymbol{\Sigma}}}_2$}  (km) &  {$\hat{\mathbf{v}}$} (km) & {$\hat{\boldsymbol{\mu}}$} (km) & {$\hat{\boldsymbol{\Sigma}}$}  (km)  \\
 \midrule
M1 & &- & - & - & - & -&$(-596.9,  -75.26)^T$   & $\left(\protect\begin{matrix} 1681 & 1097\\
    1097& 5152\protect\end{matrix}\right)$ \\
M2 & &  - & - &-& - & $(-497.4,  -39.63)^T$& - & -  \\ %3.8938402  3.5194711  0.5246596 -0.4540926  0.3932884
M3 & & $(-1285, -1228)^T$ & $(88.2, 93.8)^T$ & $\left(\protect\begin{matrix} 390.5 & -273\\
    -273 & 4373 \protect\end{matrix}\right)$ & $\left(\protect\begin{matrix} 1387 & 49.90 \\
    49.90 & 125.8 \protect\end{matrix}\right)$& - & - & -  \\
M4 & & - & - &-& - & $(-839.9, 747.9)^T$  & - &- \\ 
M5 & & - & - & -  & - & -& - & -&\\
 \bottomrule  
\end{tabular}
} 
\end{table}



The non-frozen field model, M1, outperforms its frozen counterpart, M2, according to the in-sample and out-of-sample metrics in Table~2, but at the cost of considerably more computation time, because of the numerical evaluation of a one-dimensional integral. Figure~\ref{fig:saudi_map}(d) shows that the fitted parametric model M1 captures the general behavior of the empirical spatio-temporal correlations and cross-correlation. This is not surprising, since the variability of the advection velocity vector brought about the decrease in correlations and cross-correlation with increasing $u$. This characteristic was exhibited in Figure~\ref{fig:covariance_single_velocity}(b). 

\begin{table*}[t!] %htb
\centering
\captionof{table}{\small In-sample scores using the value of the objective function defined in Section \ref{sec:estimation}, and out-of-sample prediction scores (RMSE, CRPS, WAIC) at 20 sites, with parameters estimated using 80 sites. The lower the values, the better. The best scores are in bold.}
\scalebox{0.9}{
\begin{tabular}{ccccccccccc}
    \toprule
    \multirow{2}{*}{} &
      In-Sample &
      \multicolumn{3}{c}{Out-of-Sample} & No. of  & Computation \\
     Model & $Q + \tilde{Q} + \check{Q}  $& RMSE & CRPS & WAIC & parameters & Time (secs) \\
    \cmidrule(lr){2-2}  \cmidrule(lr){3-5} \cmidrule(lr){6-6} \cmidrule(lr){7-7} 
    M1 & 1447  & $0.016$ & $\mathbf{0.007}$ & $-$626 & 15  & 6443   \\
    M2 & 1461 & $0.023$ & $0.011$ & $-$572 & 14  & 5  \\
    M3 & $\mathbf{1414}$ & $\mathbf{0.015}$ & $\mathbf{0.007}$ & $-\mathbf{641}$ & 22 & 2319  \\
    M4 & 1683 & 0.028 &  0.011 & $-$532 & 17  & 23 \\
   M5 & 1724  & 0.017 & 0.009 & $-$623 & 10 & 17  \\
    \bottomrule
  \end{tabular}
  }
\end{table*}

Lastly, according to estimates of the mean advection velocity vectors, $\tilde{\boldsymbol{\mu}}_1$ and $\tilde{\boldsymbol{\mu}}_2$, using model M3, the two latent random fields have different directions of advection. The first latent random field is advected to the Southwest, whereas the second latent random field is advected to the Northeast. Based on the estimate of the coefficient matrix $\mathbf{A}$, $Z_2$ is simply the second latent random field. Although in Figure~\ref{fig:saudi_map}(c), $Z_2$ is advected to the West/Southwest direction, the estimate for the mean advection velocity vector of the second latent random field, $\hat{\tilde{\boldsymbol{\mu}}}_2$, is in the opposite direction. This is a result one expects, when a frozen field model is fitted to a clearly non-frozen random field. Further investigation of this property are presented in Section \ref{sec:simulation}. On the other hand, $Z_1$ is the linear combination of the two latent random fields with opposing directions of advection and with more weight given to the first latent random field. This results in the first latent random field's Southwest advection having more influence on the advection of $Z_1$, which is exactly what we see in Figure~\ref{fig:saudi_map}(c). When taking into account the in-sample and out-of-sample scores (Table~2), M3 emerges as the best model. The randomness of the advection velocity vectors absorb the rapid decline of correlations and cross-correlation. With modest computation time, M3 shows that the bivariate random field is influenced by two random advection velocity vectors with opposing mean directions. The contours of the estimated distributions of the random advection velocity vectors of models M1 and M3 are shown in Figure \ref{fig:empiricaldistributionofV}(b).



\section{Simulation Study}\label{sec:simulation}

In the previous section, we showed that the non-frozen field models M1 and M3, and frozen field model M2, were the best performing models for bivariate spatio-temporal data influenced by an advection/transport phenomenon. Now, we investigate the performance of non-frozen and frozen field models, when the degree of spatio-temporal asymmetry varies. Particularly, we compare the performances of two parsimonious bivariate spatio-temporal Lagrangian Mat\'{e}rn covariance functions, M1 and M2, where the former has a random advection advection velocity vector and the latter has a constant advection velocity vector.





 
%\section{Non-Frozen vs. Frozen Field Models}\label{sec:simulation}
\subsection{Data Generation}

To replicate the conditions we had in our Saudi PM dataset, we simulate a bivariate Gaussian vector using the M4 model on 100 sites, so that each site has 248 temporal observations (8 observations per day for 31 days). We choose to perform our simulations, using the M4 model, which is the one with a spatio-temporal asymmetry parameter $\Lambda$ that can be controlled. We let $\Lambda=0,1/10,2/10,\ldots,1$ and perform 100 simulations for every value of $\Lambda$. We set the single constant advection velocity vector $\mathbf{v}=(-569.5, -169.8)^T$ to be used in the M4 simulations. Additionally, we let $\alpha=b=0.5$, and we set the other parameters for M4 to be equal to the parameter estimates in Section \ref{sec:application}  (see Table 1). Figure~\ref{fig:m4data} shows the empirical correlations and cross-correlation at $u=1$, for one simulation from M4, at each $\Lambda$. 
\begin{figure}[t!]
 \centering
\includegraphics[scale=0.47]{fig8.pdf}
  \caption{\small Rows 1-3: Empirical correlations and cross-correlation at $u=1$ for M4 simulations with different $\Lambda$. Row 4: Estimated distribution of the advection velocity vector under M1 with different $\Lambda$.}
    \label{fig:m4data}
\end{figure}



\subsection{Results and Analysis}

We fit the models M1 and M2, estimate the advection velocity parameters, and compute their respective in-sample prediction scores, $Q + \tilde{Q} + \check{Q} $. The average scores are reported in Table 3. Again, the lower the scores, the better the model fits the data. 

We are interested in analyzing how the estimated distribution of the random advection velocity vector $\mathbf{V}$ changes as the spatio-temporal asymmetry increases, i.e., as $\Lambda$ increases. For this reason, we skip the estimates of the purely spatial parameters. Likewise, we want to examine the behavior of the estimates of the advection velocity vector $\mathbf{V}$, at different values of $\Lambda$. In Figure~\ref{fig:m4data}, we can see a spectrum of spatio-temporal dependencies at $u=1$. The extreme cases include, on the far left, a random field with dissipation of spatio-temporal dependencies without advection, and on the far right, a random field with no dissipation but with advection. The former is the model described by M5, and the latter is the multivariate frozen field. 

\begin{table}[b!]
\centering
\captionof{table}{\small In-sample prediction scores, $Q + \tilde{Q} + \check{Q} $, of simulated data from M4. The best scores are in bold. }
  \scalebox{0.7}{
  \begin{tabular}{cccccccccccc}
    \toprule
   Model & $\Lambda=0$ &$\Lambda=0.1$ &$\Lambda=0.2$ &$\Lambda=0.3$&$\Lambda=0.4$&$\Lambda=0.5$&$\Lambda=0.6$&$\Lambda=0.7$&$\Lambda=0.8$&$\Lambda=0.9$&$\Lambda=1$\\
    \midrule
    M1 &  50 & \textbf{37} & 42 & \textbf{36} & 71 & 44 & 33 & 37 & \textbf{32} & 35 & \textbf{26}\\
    M2 & $3.5  \times 10^{3}$ & $2.9\times 10^{3}$ & $2.1 \times 10^{3}$ & $1.8\times 10^{3}$ & $1.7\times 10^{3}$ & $1.6\times 10^{3}$ & $9.1\times 10^{2}$ & $5.3\times 10^{2}$ & $3.3\times 10^{2}$ & $94$ & $57$ \\
    M4  &  \textbf{48} & 38 & \textbf{41} & 37 & \textbf{68} & \textbf{42} & \textbf{32} & \textbf{35} & 34 & \textbf{32} & 29\\
    \bottomrule
  \end{tabular}
  }
\end{table}


As $\Lambda$ increases, M1 is as good as M4, if not better, for modeling a bivariate spatio-temporal random field with different degrees of asymmetry (Table 3). The values of the $4$th row of Figure~\ref{fig:m4data} show that the mean of $\mathbf{V}$, in M1, captures the true advection of the random field, and that the covariance matrix of $\mathbf{V}$ captures the dissipation across time. As $\Lambda\rightarrow 1$, we get a random advection velocity vector with almost no variability. This shows that M1 can capture a wide range of spatio-temporal dependencies. 

According to Table 3, the frozen field model M2 performs well when the random field is obviously frozen. However, if we fit a frozen field model when the random field is clearly not frozen, M2 is not as good. Figure~\ref{fig:m2est} shows that, as $\Lambda$ increases, i.e., as the random field approaches the frozen field state, the estimates of the advection velocity vector for M2 converge to the true value of the advection velocity of the random field. When the field is not frozen, the distances between the estimates of the advection velocity vector and the true value are large. The norm and direction of the estimated advection velocity vector, at each $\Lambda$, compensate for the dissipation exhibited by the random field. This is the reason why the estimate of the mean advection velocity vector of the second latent random field is very far from what we observed in the empirical spatio-temporal correlation of $Z_2$. The reason why M2 performs as well as M1 (in Section \ref{sec:application}) is the inclusion of a dissipation parameter that absorbs the decrease in the maximum correlations and cross-correlation, as the temporal lag increases. Without it, the performance of a frozen field model will perform as poorly as in the simulation.

\begin{figure}[b!]
 \centering
 \includegraphics[scale=0.6]{estimate_of_v_M2.pdf}
  \caption{\small Estimates of the advection velocity vector under M2 at different values of $\Lambda$ ($0, 0.1,0.2,\ldots,1$). The red arrow is the true advection velocity used in M4 simulation.}
    \label{fig:m2est}
\end{figure}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Discussion} \label{sec:discussion}

In this paper, we proposed a multivariate extension of the covariance functions under the Lagrangian framework. Specifically, we proved the validity of the construction in the multivariate setting, where multiple variables that are advected/transported can be modeled simultaneously. This expands the range of valid spatio-temporal cross-covariance models available for geostatistical spatio-temporal analysis. In addition, we provided the semi-explicit form of the non-frozen spatio-temporal Lagrangian Mat\'{e}rn stationary cross-covariance function.

With additional parameters included in the model that convert purely spatial stationary cross-covariance functions into spatio-temporal cross-covariance functions, we proposed an estimation procedure to get sensible estimates of all parameters; we also illustrated the effectiveness of the proposed models, using a bivariate particulate matter dataset in Saudi Arabia. In addition to being the first multivariate spatio-temporal research on the considered dataset, the new proposed models outperform all the other benchmark multivariate spatio-temporal models. 

We demonstrated, through additional simulations involving model misspecification, that fitting frozen field models when the random field is clearly frozen can substantially decrease the mean square errors in the predictions; but that fitting frozen field models when the random field is apparently not frozen is damaging. Hence, we recommend the use of a non-frozen model for which the frozen field is a special case.

Lastly, the underlying purely spatial cross-covariance functions that we considered in this paper, and upon which the Lagrangian framework is proven to be valid in the multivariate case, are stationary. The validity of the Lagrangian framework on nonstationary purely spatial cross-covariance functions \citep[e.g.,][]{2012KN} or on the sphere for climate applications \citep[e.g.,][]{2013CS} have yet to be explored.


\section*{Appendix: Proofs}


\noindent {\bf Proof of Theorem \ref{theorem1}}
Let $\boldsymbol{\lambda}_l\in\mathbb{R}^{p}, \;l=1,\ldots,n.$ Then:
\begin{eqnarray*}
\sum_{l=1}^{n}\sum_{r=1}^{n}\boldsymbol{\lambda}_l^T\mathbf{C}(\mathbf{s}_{l}-\mathbf{s}_{r},t_{l}-t_{r})\boldsymbol{\lambda}_r &=& \sum_{l=1}^{n}\sum_{r=1}^{n}\boldsymbol{\lambda}_l^TE_{\mathbf{V}}\left[\mathbf{C}^S\left\{\mathbf{s}_l-\mathbf{s}_r-\mathbf{V}(t_l-t_r)\right\}\right]\boldsymbol{\lambda}_r \\
&=&\sum_{l=1}^{n}\sum_{r=1}^{n}\boldsymbol{\lambda}_l^TE_{\mathbf{V}}\left[\mathbf{C}^S\left\{(\mathbf{s}_l-\mathbf{V}t_l)-(\mathbf{s}_r-\mathbf{V}t_r)\right\}\right]\boldsymbol{\lambda}_r \\
&=&E_{\mathbf{V}}\left[\sum_{l=1}^{n}\sum_{r=1}^{n}\boldsymbol{\lambda}_l^T\mathbf{C}^S\left\{(\mathbf{s}_l-\mathbf{V}t_l)-(\mathbf{s}_r-\mathbf{V}t_r)\right\}\boldsymbol{\lambda}_r \right]\geq 0 
\end{eqnarray*}
for all $n\in\mathbb{Z}^+$ and $\left\{(\mathbf{s}_1,t_1),\ldots,(\mathbf{s}_n,t_n)\right\} \in \mathbb{R}^d\times \mathbb{R}$. The last inequality follows from the assumption that $\mathbf{C}^S$ is a valid purely spatial matrix-valued stationary covariance function on $\mathbb{R}^d$. \hfill $\Box$ \\
\vspace{-.8cm}

\noindent {\bf Proof of Proposition \ref{prop:closedformmultivariatematern}}
We sketch the derivation below. The complete version can be found in the Supplementary Material. To get the semi-explicit form, it is easier to work with the spectral density of the spatio-temporal Lagrangian Mat\'{e}rn stationary cross-covariance function:
\begin{eqnarray*}
E_{\mathbf{V}}\left\{f_{ij}(\boldsymbol{\omega},\tau)\right\} &=&\frac{1}{2\pi} f_{ij}(\boldsymbol{\omega})  \int_{\mathbb{R}} E_{\mathbf{V}}\left[\exp\left\{iu\left(\tau-\boldsymbol{\omega}^T\mathbf{V}\right) \right\}\right]\dd u \nonumber \\
&=&\frac{1}{2\pi} f_{ij}(\boldsymbol{\omega})  \int_{\mathbb{R}} \exp(iu\tau) \exp\left(-iu\boldsymbol{\omega}^T\boldsymbol{\mu}-\frac{1}{2}u^2\boldsymbol{\omega}^T\boldsymbol{\Sigma}\boldsymbol{\omega}\right) \dd u \nonumber \\
&=&\frac{1}{2\pi}\frac{\Gamma\left(\nu_{ij}+\frac{d}{2}\right)}{\Gamma\left(\nu_{ij}\right)\pi^{d/2}a_{ij}^{d}} \frac{1}{\left(1+\frac{\|\boldsymbol{\omega}\|^2}{a_{ij}^2}\right)^{\nu_{ij}+d/2}} \int_{\mathbb{R}} \exp(iu\tau) \exp\left(-iu\boldsymbol{\omega}^T\boldsymbol{\mu}-\frac{1}{2}u^2\boldsymbol{\omega}^T\boldsymbol{\Sigma}\boldsymbol{\omega}\right) \dd u.
\end{eqnarray*}
Taking the inverse Fourier transform to get $C_{ij}(\mathbf{h},u)=E_{\mathbf{V}}\left\{C_{ij}\left(\mathbf{h}-u\mathbf{V}\right)\right\}$, we obtain (\ref{eqn:closedformmultivariatematern}).\hfill $\Box$
\vspace{.2cm}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\noindent {\bf Proof of Proposition \ref{expectedlagrangianlmc}}
The validity of $\mathbf{C}(\mathbf{h}, u)$ is established by considering a spatio-temporal extension of (\ref{eqn:lmcprocess}), i.e.,
$\mathbf{Z}(\mathbf{s},t)=\mathbf{A} {\bf W}(\mathbf{s},t)$, with ${\bf W}(\mathbf{s},t)=\{W_{1}(\mathbf{s}-\mathbf{V}_1t),\ldots,W_{R}(\mathbf{s}-\mathbf{V}_R t)\}^T$,
where $\mathbf{A}$ is $p\times R,\;R\leq p$ and $\mathbf{V}_{r}\in \mathbb{R}^d,\;r=1,\ldots,R$, are random vectors on $\mathbb{R}^d$. Taking the expectation of the resulting cross-covariance function with respect to $\mathbf{V}_{r},\;r=1,\ldots,R$, yields
$
\mathbf{C}(\mathbf{h}, u)=\sum_{r=1}^{R} E_{\mathbf{V}_r}\left\{\rho_r(\mathbf{h}-u\mathbf{V}_r)\right\} \mathbf{T}_r,
$
which is a valid cross-covariance function on $\mathbb{R}^d$ since each $E_{\mathbf{V}_r}\left\{\rho_r(\mathbf{h}-u\mathbf{V}_r)\right\}$ is a valid covariance function on $\mathbb{R}$. \hfill $\Box$
\vspace{.2cm}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\noindent {\bf Proof of Proposition \ref{corollary1}}
Given a multivariate purely spatial stationary random field $\tilde{\mathbf{Z}}(\mathbf{s})$, define a multivariate spatio-temporal random field 
$\mathbf{Z}(\mathbf{s},t)=\{\tilde{Z}_1\left(\mathbf{s}-\mathbf{v}_{11}t\right),\ldots,\tilde{Z}_p\left(\mathbf{s}-\mathbf{v}_{pp}t\right)\}^T$,
where $\mathbf{v}_{ii},\;i=1,\ldots,p$, are vectors on $\mathbb{R}^d$. The covariance between variables $i$ and $j$ taken at spatio-temporal locations $(\mathbf{s}_l,t_l)$ and $(\mathbf{s}_r,t_r)$, for any $l,r=1,\ldots,n,$ is
\begin{eqnarray*}
\mbox{cov}\left\{Z_{i}(\mathbf{s}_l,t_l),Z_{j}(\mathbf{s}_r,t_r)\right\} &=& \text{cov}\left\{\tilde{Z}_{i}(\mathbf{s}_l-\mathbf{v}_{ii}t_l),\tilde{Z}_{j}(\mathbf{s}_r-\mathbf{v}_{jj}t_r)\right\}
=C_{ij}\left\{\left(\mathbf{s}_l-\mathbf{v}_{ii}t_l\right)-\left(\mathbf{s}_r-\mathbf{v}_{jj}t_r\right)\right\}\\
&=& C_{ij}\left(\mathbf{h}-\mathbf{v}_{ii}t_l+\mathbf{v}_{jj}t_r\right)
=C_{ij}\left\{\mathbf{h}-\mathbf{v}_{ii}\left(m+\frac{u}{2}\right)+\mathbf{v}_{jj}\left(m-\frac{u}{2}\right)\right\}\\
&=& C_{ij}\left\{\mathbf{h}-\overline{\mathbf{v}}_{ij}u+\left(\mathbf{v}_{jj}-\mathbf{v}_{ii}\right)m\right\},
\end{eqnarray*}
where $u=t_l-t_r$, $m=\frac{t_l+t_r}{2}$, and $\overline{\mathbf{v}}_{ij}=\frac{\mathbf{v}_{ii}+\mathbf{v}_{jj}}{2}$. \hfill $\Box$



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% ieeetr
\baselineskip=20pt
%\bibliographystyle{plainnat}
\bibliographystyle{apalike}
\bibliography{main}
\end{document}



